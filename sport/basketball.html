<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>籃球計分板</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <header>
    <div class="container row space-between">
      <h1>🏀 籃球計分板</h1>
      <div class="row">
        <button id="btnExport" class="btn">匯出 TXT</button>
        <button id="btnUpdate" class="btn-accent">更新（覆寫同檔）</button>
        <button id="btnReset" class="btn-danger">清空本場</button>
      </div>
    </div>
    <div class="container tabs-wrap">
      <div class="tabs">
        <button class="tab active" data-view="scoreView">計分板</button>
        <button class="tab" data-view="playersView">球員索引</button>
        <button class="tab" data-view="rulesView">規則設定</button>
      </div>
    </div>
  </header>

  <main class="container main">
    <!-- 計分板 View -->
    <div id="scoreView" class="view active">
      <div class="grid grid-3">
        <!-- Scoreboard + Team Fouls -->
        <section class="card">
          <div class="row space-between">
            <div>
              <div class="label">主隊</div>
              <div class="score" id="homeScore">0</div>
              <div class="row">
                <button data-add="home:1">+1</button>
                <button data-add="home:2">+2</button>
                <button data-add="home:3">+3</button>
                <button data-add="home:-1">-1</button>
              </div>
              <div class="row mt8 center">
                <span class="label">團隊犯規</span>
                <span id="homeFouls" class="foul-count">0</span>
                <span id="homeBonus" class="bonus" style="display:none">Bonus</span>
              </div>
              <div class="row">
                <button data-tf="home:-1">-</button>
                <button data-tf="home:1" class="btn-warn">+ 犯規</button>
                <button id="homeFoulsReset">本節清零</button>
              </div>
            </div>

            <div>
              <div class="label">客隊</div>
              <div class="score" id="awayScore">0</div>
              <div class="row">
                <button data-add="away:1">+1</button>
                <button data-add="away:2">+2</button>
                <button data-add="away:3">+3</button>
                <button data-add="away:-1">-1</button>
              </div>
              <div class="row mt8 center">
                <span class="label">團隊犯規</span>
                <span id="awayFouls" class="foul-count">0</span>
                <span id="awayBonus" class="bonus" style="display:none">Bonus</span>
              </div>
              <div class="row">
                <button data-tf="away:-1">-</button>
                <button data-tf="away:1" class="btn-warn">+ 犯規</button>
                <button id="awayFoulsReset">本節清零</button>
              </div>
            </div>
          </div>

          <hr class="divider" />
          <div class="grid grid-2">
            <div class="row">
              <div class="flex1">
                <div class="label">節次</div>
                <div class="row">
                  <button id="periodDec">-</button>
                  <div id="period" class="score small">第1節</div>
                  <button id="periodInc">+</button>
                </div>
              </div>
              <div class="flex1">
                <div class="label">比賽資訊</div>
                <input id="gameTitle" placeholder="比賽名稱（例：聯賽A：主隊 vs 客隊）" />
              </div>
            </div>
          </div>
        </section>

        <!-- Game Clock -->
        <section class="card">
          <div class="row space-between">
            <div class="label">比賽計時（Game Clock）</div>
            <span class="chip">OT 自動 5:00；到 0 自動下一節</span>
          </div>
          <div class="game-face">
            <div id="gameDisplay" class="game-display">12:00</div>
            <div id="gameInfo" class="muted">長度：12:00</div>
          </div>
          <div class="row center">
            <button id="gameStart" class="btn-accent">開始</button>
            <button id="gamePause">暫停</button>
            <button id="gameReset">重置本節</button>
            <button id="set12">12:00</button>
            <button id="set10">10:00</button>
            <button id="set5">5:00</button>
            <button id="toggleLink">與 24s 連動：關</button>
          </div>
        </section>

        <!-- Shot Clock + 事件面板 -->
        <section class="card">
          <div class="row space-between">
            <div class="label">進攻時計（24s / 14s）</div>
            <span class="chip">≤8 秒顯示到 0.01；到 0 自動違例</span>
          </div>
          <div class="shot-face">
            <div id="shotDisplay" class="shot-display">24</div>
            <div id="shotPos" class="muted">球權：主隊</div>
          </div>
          <div class="row center">
            <button id="shotStart" class="btn-accent">開始</button>
            <button id="shotPause">暫停</button>
            <button id="shotReset24">重置 24</button>
            <button id="shotReset14">重置 14</button>
            <button id="shotMinus">-1s</button>
            <button id="shotPlus">+1s</button>
            <button id="shotSwap">切換球權</button>
            <button id="shotViolation" class="btn-danger">判 24 秒違例</button>
          </div>

          <hr class="divider">
          <div class="label">快速情境</div>
          <div class="row">
            <button id="qaOffReb14" title="進攻籃板後重置 14 秒">進攻籃板（14s）</button>
            <button id="qaChangePoss24" title="防守籃板或失誤等換球權重置 24 秒">換球權（24s）</button>
          </div>

          <hr class="divider">
          <div class="label">犯規 / 事件面板（選隊伍＋背號後點事件）</div>
          <div class="row">
            <select id="evtTeam">
              <option value="home">主隊</option>
              <option value="away">客隊</option>
            </select>
            <input id="evtNum" type="number" placeholder="背號" style="width:110px" />
          </div>
          <div class="opset mt8">
            <button id="evDefCommon" class="opbtn btn-warn">防守犯規 → 對方兩罰</button>
            <button id="evOffensive" class="opbtn btn-warn">進攻犯規（控球）</button>
            <button id="evShoot2" class="opbtn btn-warn">投籃犯規（2罰）</button>
            <button id="evShoot3" class="opbtn btn-warn">投籃犯規（3罰）</button>
            <button id="evAnd1" class="opbtn btn-warn">And-1（投籃成球）</button>
            <button id="evTechnical" class="opbtn btn-warn">技術犯規（T）</button>
            <button id="evUnsports" class="opbtn btn-warn">違體犯規（U）</button>
          </div>

          <div class="label mt12">備註（可寫入TXT）</div>
          <textarea id="notes" rows="6" placeholder="例：第三節 05:22 主隊 10:0 攻勢，#7 三分追平"></textarea>
        </section>
      </div>
    </div>

    <!-- 球員索引 View -->
    <div id="playersView" class="view">
      <section class="card">
        <div class="row space-between">
          <div class="label">球員索引 / 新增球員</div>
          <span class="chip">犯(總)達上限自動標紅；T/U 到上限標記退場</span>
        </div>
        <div class="grid grid-2 mt8">
          <input id="pNum" type="number" placeholder="背號（數字）"/>
          <input id="pName" placeholder="姓名"/>
          <select id="pTeam">
            <option value="home">主隊</option>
            <option value="away">客隊</option>
          </select>
          <input id="pPos" placeholder="位置（G/F/C）"/>
        </div>
        <div class="row mt8">
          <button id="addPlayer" class="btn-accent">加入名單</button>
          <span class="muted">重複背號會覆蓋該隊同背號。</span>
        </div>

        <div class="table-wrap">
          <table id="playersTbl">
            <thead>
              <tr>
                <th>隊伍</th><th>背號</th><th>姓名</th><th>位置</th>
                <th>分</th><th>犯(總)</th><th>進攻</th><th>技</th><th>違體</th>
                <th>助</th><th>板</th><th>抄</th><th>阻</th><th>失</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody><!-- rows --></tbody>
          </table>
        </div>
      </section>
    </div>

    <!-- 規則設定 View -->
    <div id="rulesView" class="view">
      <section class="card">
        <div class="label">犯規計數規則（哪些算入團隊犯規）</div>
        <div class="grid grid-2 mt12">
          <label><input type="checkbox" id="ruleCountCommon" checked> 一般犯規 計入團隊</label>
          <label><input type="checkbox" id="ruleCountOffensive"> 進攻犯規 計入團隊</label>
          <label><input type="checkbox" id="ruleCountTechnical"> 技術犯規 計入團隊</label>
          <label><input type="checkbox" id="ruleCountUnsportsmanlike" checked> 違體犯規 計入團隊</label>
        </div>
        <hr class="divider">
        <div class="label">上限 & 退場條件</div>
        <div class="grid grid-2 mt12">
          <label>個人犯規上限（PF）<input id="limitPF" type="number" min="1" max="6" value="5" /></label>
          <label>技術犯規上限（T）<input id="limitT" type="number" min="1" max="3" value="2" /></label>
          <label>違體犯規上限（U）<input id="limitU" type="number" min="1" max="3" value="2" /></label>
        </div>
        <div class="row mt12">
          <button id="presetFIBA">FIBA 預設</button>
          <button id="presetNBA">NBA 預設</button>
          <span class="muted">（勾選與上限可依賽制微調）</span>
        </div>
                <!-- NEW: 裁判資訊 -->
        <hr class="divider">
        <div class="label">裁判資訊（本場執行裁判）</div>
        <div class="grid grid-2 mt12">
          <label>裁判長（Crew Chief）
            <input id="refCrew" placeholder="例：王小明" />
          </label>
          <label>第一副審（Umpire 1）
            <input id="refU1" placeholder="例：李大華" />
          </label>
          <label>第二副審（Umpire 2）
            <input id="refU2" placeholder="例：陳小美" />
          </label>
        </div>
      </section>
    </div>
  </main>

  <script src="./app.js"></script>
</body>
</html>